# Reversing

 - https://www.pentestpartners.com/security-blog/how-to-do-firmware-analysis-tools-tips-and-tricks/
 - https://advancedpersistentjest.com/2017/06/19/reversing-the-balong-m3mcu-console-lightning-the-path-to-ring-0/
 - https://blog.ret2.io/2017/11/16/dangers-of-the-decompiler/
 - https://puri.sm/posts/primer-to-reverse-engineering-intel-fsp/
 - https://quequero.org/2017/07/arm-exploitation-iot-episode-1/
 - https://quequero.org/2017/09/arm-exploitation-iot-episode-2/
 - https://quequero.org/2017/11/arm-exploitation-iot-episode-3/
 - http://kakaroto.homelinux.net/2017/11/introduction-to-reverse-engineering-and-assembly/
 - https://rdomanski.github.io/Reverse-engineering-of-ARM-Microcontrollers/
 - http://grangeia.io/2015/11/30/hacking-tomtom-runner-pt3/
 - [Reverse Engineering using the Linux Operating System](http://reverse.lostrealm.com/)
 - [Breaking State-of-the-Art Binary Code Obfuscation](https://recon.cx/2018/brussels/resources/slides/RECON-BRX-2018-Breaking-state-of-the-art-binary-code-obfuscation.pdf)
 - RECON Bruxelles 2018 [slide](https://recon.cx/2018/brussels/slides/)
 - [BOLO: Reverse Engineering — Part 1 (Basic Programming Concepts)](https://medium.com/@danielabloom/bolo-reverse-engineering-part-1-basic-programming-concepts-f88b233c63b7)
 - [Starting Embedded Reverse Engineering: FreeRTOS, libopencm3 on STM32F103C8T6](https://blog.3or.de/starting-embedded-reverse-engineering-freertos-libopencm3-on-stm32f103c8t6.html)
 - [Intro to x64 reversing](https://pdfs.semanticscholar.org/presentation/a653/8fe41866bc0937f3aaaeb7f16f2be72f2369.pdf)
 - [Ida- how to find connection between 2 functions](https://reverseengineering.stackexchange.com/questions/17659/ida-how-to-find-connection-between-2-functions)
 - [How to Hack an Expensive Camera and Not Get Killed by Your Wife](https://alexhude.github.io/2019/01/24/hacking-leica-m240.html)
 - [Deobfuscating MoVfuscator - Part 2](https://x0r19x91.github.io/2019/swamp-future-fun)
 - [[DSCTF 2019] CPU Adventure – Unknown CPU Reversing](https://www.robertxiao.ca/hacking/dsctf-2019-cpu-adventure-unknown-cpu-reversing/)
 - [Weisfeiler-Lehman Graph Kernel for Binary Function Analysis](https://blog.quarkslab.com/weisfeiler-lehman-graph-kernel-for-binary-function-analysis.html)
 - [malrev/ABD](https://github.com/malrev/ABD) Course materials for Advanced Binary Deobfuscation by NTT Secure Platform Laboratories
 - [Bootstrapping Understanding](http://www.muppetlabs.com/~breadbox/txt/bure.html): reversing the level data file for "Chip's Challenge" game
 - [Reverse engineering Flutter apps (Part 1)](https://blog.tst.sh/reverse-engineering-flutter-apps-part-1/)
 - [Analyzing the USB Controller's Firmware](https://8051enthusiast.github.io/2020/04/14/001-USB_Firmware.html)
 - [Advanced Binary Deobfuscation](https://github.com/malrev/ABD)
 

## Protocol

 - [Analyzing WhatsApp Calls with Wireshark, radare2 and Frida](https://medium.com/@schirrmacher/analyzing-whatsapp-calls-176a9e776213)

## Hardware

### Links

 - [zeptobars](https://zeptobars.com/en/)
 - [visual6502](http://visual6502.org/)
 - [siliconpr0n](http://siliconpr0n.org/)
 - [CSCI 4974 / 6974 Hardware Reverse Engineering](http://security.cs.rpi.edu/courses/hwre-spring2014/)
 - [UPC UBEE EVW3226 WPA2 Password Reverse Engineering](https://deadcode.me/blog/2016/07/01/UPC-UBEE-EVW3226-WPA2-Reversing.html)
 - [im-me LCD Interface Hacked](https://daveshacks.blogspot.it/2010/01/im-me-lcd-interface-hacked.html)
 - [Reverse Engineering Flash Memory for Fun and Benefit](https://www.blackhat.com/docs/us-14/materials/us-14-Oh-Reverse-Engineering-Flash-Memory-For-Fun-And-Benefit-WP.pdf)
 - [Reverse Engineering the TP-Link HS110](https://www.softscheck.com/en/reverse-engineering-tp-link-hs110/)
 - [Embedded Devices Security Firmware Reverse Engineering](https://media.blackhat.com/us-13/US-13-Zaddach-Workshop-on-Embedded-Devices-Security-and-Firmware-Reverse-Engineering-Slides.pdf)
 - [Reversing the parrot skycontroller firmware](http://thecyberrecce.net/2017/01/09/reversing-the-parrot-skycontroller-firmware/)
 - [Reverse Engineering the TP-Link HS110](https://www.softscheck.com/en/reverse-engineering-tp-link-hs110/)
 - [depcb](https://github.com/unixdj/depcb): PCB Reverse Engineering tool
 - [Reversing the 76477 "Space Invaders" sound effect chip from die photos](http://www.righto.com/2017/04/reverse-engineering-76477-space.html)
 - [NMOS IC Reverse Engineering](https://www.wdj-consulting.com/blog/nmos-sample.html)
 - [Video](https://www.youtube.com/watch?v=aHx-XUA6f9g) Reading Silicon: How to Reverse Engineer Integrated Circuits
 - [Pwn2Win 2017 - Shift Register](http://blog.dragonsector.pl/2017/10/pwn2win-2017-shift-register.html)
 - [Silicon die analysis: inside an op amp with interesting "butterfly" transistors](http://www.righto.com/2018/06/silicon-die-analysis-op-amp-with.html)
 - [Reverse Engineering a Philips TriMedia CPU based IP camera - Part 1](https://blog.quarkslab.com/reverse-engineering-a-philips-trimedia-cpu-based-ip-camera-part-1.html)
 - [REVERSE ENGINEERING ARCHITECTURE AND PINOUT OF CUSTOM ASICS](https://sec-consult.com/en/blog/2019/02/reverse-engineering-architecture-pinout-plc/)
 - [Hardware Debugging for Reverse Engineers Part 1: SWD, OpenOCD and Xbox One Controllers](https://wrongbaud.github.io/stm-xbox-jtag/)
 - [Reverse Engineering a Digital Answering Machine (part 1)](https://ivanwick.github.io/2020/03/15/answering-machine-pt1.html)
 - [Reversing TL-WR840N](https://therealunicornsecurity.github.io/TPLink/)
 - [Reverse Engineering an Unknown Microcontroller](http://dmitry.gr/?r=05.Projects&proj=30.%20Reverse%20Engineering%20an%20Unknown%20Microcontroller)

## Software

 - [Reverse engineering and removing Pokémon GO’s certificate pinning](https://eaton-works.com/2016/07/31/reverse-engineering-and-removing-pokemon-gos-certificate-pinning/)
 - [Toy decompiler for x86-64 written in Python](https://yurichev.com/writings/toy_decompiler.pdf)
 - [Finding the actual Thumb code in firmware](https://reverseengineering.stackexchange.com/questions/5945/finding-the-actual-thumb-code-in-firmware)
 - [Reverse Engineering Exercises](https://github.com/rotlogix/arm_reverse_engineering_exercises) for ARM
 - [Static analysis of an unknown compression format](https://blog.lse.epita.fr/articles/8-static-analysis-of-an-unknown-compression-format.html)
 - [Reverse Engineering Encrypted Code Segments](https://medium.com/@ryancor/reverse-engineering-encrypted-code-segments-b01aead67701)
 - [Reverse engineer USB stack of Exynos BootROM](https://fredericb.info/2020/06/reverse-engineer-usb-stack-of-exynos-bootrom.html)
 - [r2-pay: anti-debug, anti-root & anti-frida (part 1)](https://www.romainthomas.fr/post/20-09-r2con-obfuscated-whitebox-part1/)
 - [r2-pay: whitebox (part 2)](https://www.romainthomas.fr/post/20-09-r2con-obfuscated-whitebox-part2/)
 - [Undocumented Fastboot Oem Commands](https://carlo.marag.no/posts/undocumented-fastboot-oem/)

### ARM

 - [S6 Sboot](https://blog.quarkslab.com/reverse-engineering-samsung-s6-sboot-part-i.html)
 - [Reverse-engineering Samsung Exynos 9820 bootloader and TZ](http://allsoftwaresucks.blogspot.com/2019/05/reverse-engineering-samsung-exynos-9820.html?m=1)

### C++

 - [Reversing C++ Virtual Functions: Part 1](https://alschwalm.com/blog/static/2016/12/17/reversing-c-virtual-functions/)
 - [Reversing C++](https://www.blackhat.com/presentations/bh-dc-07/Sabanal_Yason/Paper/bh-dc-07-Sabanal_Yason-WP.pdf)
 - [How to find the location of the vtable?](https://reverseengineering.stackexchange.com/questions/5956/how-to-find-the-location-of-the-vtable/)
 - [Guidelines to MFC reversing](https://quequero.org/2008/08/guidelines-to-mfc-reversing/)

### Win32

 - [How to GetProcAddress() like a boss](https://blog.benoitblanchon.fr/getprocaddress-like-a-boss/)
 - [Reversing Microsoft Visual C++ Part I: Exception Handling](http://www.openrce.org/articles/full_view/21)
 - [Reversing Microsoft Visual C++ Part II: Classes, Methods and RTTI](http://www.openrce.org/articles/full_view/23)
 - [PortEx](https://github.com/katjahahn/PortEx) Java library to analyse Portable Executable files with a special focus on malware analysis and PE malformation robustness
 - [Applied Reverse Engineering: Exceptions And Interrupts](https://revers.engineering/applied-re-exceptions/)
 - [Methodology for Static Reverse Engineering of Windows Kernel Drivers](https://posts.specterops.io/methodology-for-static-reverse-engineering-of-windows-kernel-drivers-3115b2efed83)

### Java

 - [Introduction to Radare Java Reverse Engineering](http://deeso.github.io/posts/2014/04/radare-java-intro/)
 - [Using Radare to Enumerate Artifacts in a Java Class File](http://deeso.github.io/posts/2014/04/radare-java-artifact-enumeration/)
 - [The Java Virtual Machine Instruction Set](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html)
 - [Exploring Java bytecode](https://blog.nishtahir.com/2015/09/12/exploring-java-byte-code/)

It is possible to edit a single class file and save it, after that you can reput it into the jar with

```
$ jar uf jar-file input-file(s)
```

If you want to quickly find class names you can launch this oneliner 

```
$ for f in $(ls /path/to/jars/*); do echo '-- '$f' --';strings -10 $f;done | less
```

An example with ``radare2`` of what you can see reversing the simple ``hello world`` program:

```
/ (fcn) sym.HelloWorld.main 9
|   sym.HelloWorld.main ();
|           0x00000183      b20002         getstatic java/lang/System/out Ljava/io/PrintStream;
|           0x00000186      1203           ldc "Hello, World"
|           0x00000188      b60004         invokevirtual java/io/PrintStream/println(Ljava/lang/String;)V
\           0x0000018b      b1             return
[0x00000158]> is
[Symbols]
Num Paddr      Vaddr      Bind     Type Size Name
000 0x00000158 0x00000158   NONE   FUNC    5 <init>
000 0x00000142 0x00000142   NONE FUNC_META   43 meta_<init>
001 0x00000183 0x00000183   NONE   FUNC    9 main
001 0x0000016d 0x0000016d   NONE FUNC_META   51 meta_main
001 0x00000001 0x00000001   NONE import    0 imp.<init>
002 0x00000002 0x00000002   NONE import    0 imp.out
004 0x00000004 0x00000004   NONE import    0 imp.println

[0x00000158]> iz
[Strings]
Num Vaddr      Paddr      Len Size Section  Type  String
007 0x00000022 0x00000022   6   9 () ascii <init>
008 0x0000002b 0x0000002b   3   6 () ascii ()V
009 0x00000031 0x00000031   4   7 () ascii Code
010 0x00000038 0x00000038  15  18 () ascii LineNumberTable
011 0x0000004a 0x0000004a   4   7 () ascii main
012 0x00000051 0x00000051  22  25 () ascii ([Ljava/lang/String;)V
013 0x0000006a 0x0000006a  10  13 () ascii SourceFile
014 0x00000077 0x00000077  15  18 () ascii HelloWorld.java
018 0x00000096 0x00000096  12  15 () ascii Hello, World
021 0x000000ad 0x000000ad  10  13 () ascii HelloWorld
022 0x000000ba 0x000000ba  16  19 () ascii java/lang/Object
023 0x000000cd 0x000000cd  16  19 () ascii java/lang/System
024 0x000000e0 0x000000e0   3   6 () ascii out
025 0x000000e6 0x000000e6  21  24 () ascii Ljava/io/PrintStream;
026 0x000000fe 0x000000fe  19  22 () ascii java/io/PrintStream
027 0x00000114 0x00000114   7  10 () ascii println
028 0x0000011e 0x0000011e  21  24 () ascii (Ljava/lang/String;)V
```

### Go

 - [The Go low-level calling convention on x86-64](https://science.raphael.poss.name/go-calling-convention-x86-64.html)
 - [Reversing GO binaries like a pro](https://rednaga.io/2016/09/21/reversing_go_binaries_like_a_pro/)
 - [Reverse Engineering Go, Part I](https://blog.osiris.cyber.nyu.edu/2019/12/19/go-deepdive/)

### Android 

 - http://www.juanurs.com/Bypassing-Android-Anti-Emulation-Part-II/
 - [Kotlin and Java: How Hackers See Your Code](https://brompwnie.github.io/reversing/2018/02/12/Kotlin-and-Java-How-Hackers-See-Your-Code.html)
 - [Android application reversing 101](https://www.evilsocket.net/2017/04/27/Android-Applications-Reversing-101/)
 - [Android OWASP crackmes: Write-up UnCrackable Level 2](https://enovella.github.io/android/reverse/2017/05/20/android-owasp-crackmes-level-2.html)
 - [Reversing HackEx - An android game](https://0x00sec.org/t/reversing-hackex-an-android-game/16243/3)
 - [CyberTruckChallenge](https://www.verso.re/posts/cybertruck/) The CyberTruckChallenge is a workshop about Android Security sponsored by NowSecure and created by @enovella.
 - [shroudedcode/apk-mitm](https://github.com/shroudedcode/apk-mitm) A CLI application that prepares Android APK files for HTTPS inspection
 - [fkie-cad/DeStroid](https://github.com/fkie-cad/DeStroid) Fighting String Encryption in Android Malware
 - [Reverse engineering Flutter for Android](https://rloura.wordpress.com/2020/12/04/reversing-flutter-for-android-wip/)

### Python

 - [Looking inside the box](https://anvilventures.com/blog/looking-inside-the-box.html): notes about reversing Dropbox's client

### SEGA

 - [PHDays "Best Reverser" contest (SEGA Genesis/MD ROM) write-up](https://romhack.github.io/doc/segaBestReverserWriteup/)
 - [SEGA Genesis ROM hacking](https://zznop.github.io/romhacking/2019/03/14/sega-genesis-rom-hacking-with-ghidra.html)

### WASM

> WebAssembly is a new type of code that can be run in modern web browsers and
> provides new features and major gains in performance. It is not primarily
> intended to be written by hand, rather it is designed to be an effective
> compilation target for low-level source languages like C, C++, Rust, etc.

There are currently two distinct sets of tools that are of interest to compiler
writers or developers who want to work with WebAssembly binary generated by
other tools like Emscripten:

 - [WABT](https://github.com/WebAssembly/wabt) - The WebAssembly Binary Toolkit
 - [Binaryen](https://github.com/WebAssembly/binaryen) - Compiler and toolchain infrastructure

#### Links

 - [Specification](https://webassembly.github.io/spec/core/index.html)
 - [Mozill's documentation](https://developer.mozilla.org/en-US/docs/WebAssembly)
 - [WASM fiddle](https://wasdk.github.io/WasmFiddle/)
 - [Reversing WASM](https://www.pnfsoftware.com/reversing-wasm.pdf)
 - [wasmdec](https://github.com/wwwg/wasmdec) WebAssembly to C decompiler
 - [Writing WebAssembly By Hand](https://blog.scottlogic.com/2018/04/26/webassembly-by-hand.html)

## Tools

### Z3

MIT licensed SMT solver from Microsoft Research

 - [Z3 API in Python](https://github.com/Z3Prover/z3/blob/master/examples/python/tutorial/jupyter/guide.ipynb)
 - [Breaking Algorithms - SMT Solvers for WebApp Security](https://alephsecurity.com/2019/09/02/Z3-for-webapp-security/)

### Binwalk

```
$ git clone https://github.com/devttys0/binwalk && cd binwalk
$ sudo ./deps.sh
$ sudo python setup.py install
```

### Plasma

Interactive disassembler for x86/ARM/MIPS. Generates indented pseudo-code with colored syntax code.

This is the [github repo](https://github.com/joelpx/plasma). The installation instructions are strange
but a simple

```
$ pip3 install -r requirements.txt
$ ./install.sh --update
```

(use ``update`` also the first time otherwise it will clone ``capstone`` without reason).

```
$ plasma -i /opt/low-level/docs/code/payload-eater_x86
plasma> help
analyzer
      Analyzer status.
dump SYMBOL|0xXXXX|EP [NB_LINES]
      Print contents at the specified address.
exit
      Exit
frame_size [SYMBOL|0xXXXX|EP] frame_size
      Change the frame size of a function, the function will be re-analyzed.
functions
      Print the function list.
help
      Display this help.
hexdump SYMBOL|0xXXXX|EP [NB_LINES]
      Dump memory in hexa.
history
      Display the command history.
info
      Information about the current binary.
jmptable INST_ADDR TABLE_ADDR NB_ENTRIES SIZE_ENTRY
      Create a jump table referenced at TABLE_ADDR and called
      from INST_ADDR.
memmap
      Open a qt window to display the memory.
mips_set_gp ADDR
      Set the register $gp to a fixed value. Note that it will
      erase all defined memory.
py [!][FILE]
      Run an interactive python shell or execute a script.
      Global variables api and args will be passed to the script.
      The character ! is an alias to the scripts directory.
push_analyze_symbols
      Force to analyze the entry point, symbols and a memory scan will be done.
rename OLD_SYM NEW_SYM
      Rename a symbol.
save
      Save the database.
sections
      Print all sections.
sym [SYMBOL 0xXXXX] [| FILTER]
      Print all symbols or set a new symbol.
      You can filter symbols by searching the word FILTER.
      If FILTER starts with -, the match is inversed.
x [SYMBOL|0xXXXX|EP]
      Decompile and print on stdout. By default it will be main.
      The decompilation is forced, it dosn't check if addresses
      are defined as code.
v [SYMBOL|0xXXXX|EP|%VISUAL]
      Visual mode: if no address is given, previous visual is
      reopen. You can keep up to 3 visuals. Use %1, %2 or %3
      to select the visual.

      Main shortcuts:
      c       create code
      b/w/d/Q create byte/word/dword/qword
      a       create ascii string
      p       create function
      o       set [d|q]word as an offset
      *       create an array
      x       show xrefs
      r       rename
      space   highlight current word (ctrl-k to clear)
      ;       edit inline comment (enter/escape to validate/cancel)
      U       undefine

      Options:
      I       switch to traditional instruction string output (3 modes)
      M       show/hide mangling
      B       show/hide bytes

      Navigation:
      |       split the window
      j       jump to an address or a symbol
      /       binary search: if the first char is ! you can put an
              hexa string example: /!ab 13 42
              the search is case sensitive.
      n/N     next/previous search occurence
      g       top
      G       bottom
      z       set current line on the middle
      %       goto next bracket
      { }     previous/next paragraph
      tab     switch between dump/decompilation
      enter   follow address
      escape  go back
      u       re-enter
      q       quit
xrefs SYMBOL|0xXXXX|EP
      Print cross references to the specified address.
```

### Vivisect

This the [github](https://github.com/pdasilva/vivisect) page.

### Capstone

[Home page](http://www.capstone-engine.org/)

Below a random dump of the instruction to cross compile it
for ARM

```
# apt-get install gcc-arm-linux-gnueabi
$ git clone https://github.com/aquynh/capstone && cd capstone
$ CROSS=arm-linux-gnueabi- ./make.sh
 ...
$ file libcapstone.so
libcapstone.so: ELF 32-bit LSB  shared object, ARM, EABI5 version 1 (SYSV), dynamically linked, BuildID[sha1]=d3aa90b9edfef4bdd461ac5908c7a2ec08b7d199, not stripped
```
